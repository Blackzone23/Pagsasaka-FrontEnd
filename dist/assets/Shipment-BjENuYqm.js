import"./lodash-l93d-5Mt.js";import{A as p,i as Q,f as u,g as m,D as Y,c as n,b as t,l as g,a as L,u as I,I as O,k as v,F as h,h as x,t as a,j as J,o as r,d as K}from"./index-PUpkw_HF.js";import{E as X}from"./jspdf.es.min-BoopFBso.js";import Z from"./html2canvas.esm-CBrSDip1.js";const tt={class:"flex min-h-screen bg-gray-100"},et={class:"flex-1 flex flex-col"},st={class:"bg-[#285a19] shadow p-4 flex justify-between items-center text-white"},ot={class:"flex items-center space-x-4"},at={class:"relative inline-block text-left"},lt={class:"flex items-center space-x-2"},nt=["src"],rt={key:0,class:"absolute right-0 z-50 mt-2 w-48 bg-white rounded shadow-lg"},dt={class:"p-5"},it={key:0},ct={class:"mb-4 text-sm flex flex-wrap gap-2"},ut={key:0,class:"table-auto w-full border-collapse border border-gray-300"},pt=["onClick"],gt={class:"px-4 py-2"},ht={class:"px-4 py-2"},xt={class:"px-4 py-2"},mt={class:"px-4 py-2"},bt={class:"px-4 py-2"},vt={key:0,class:"table-auto w-full border-collapse border border-gray-300"},ft=["onClick"],yt={class:"px-4 py-2"},_t={class:"px-4 py-2"},wt={class:"px-4 py-2"},kt={class:"px-4 py-2"},Ct={class:"px-4 py-2"},St={class:"flex-1 text-center"},Lt={class:"text-lg font-bold"},It={class:"text-sm"},Ot={key:0},Pt={class:"relative flex items-center justify-center mt-6"},Ut={class:"flex space-x-10 md:space-x-[60px] z-10"},Dt={class:"flex space-x-4 md:space-x-[47px] justify-center items-center text-center mt-2 text-xs md:text-sm"},jt={class:"mt-8"},Tt={key:0,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50"},Mt={class:"bg-white w-[700px] p-4 rounded-lg relative packing-slip-modal-content"},Rt={class:"mt-10 w-full"},Nt={class:"text-center mb-2"},Ft={class:"font-semibold"},Wt={class:"text-xs"},Vt={class:"grid grid-cols-2 gap-2 border-y py-2 mb-2"},$t={class:"font-bold"},zt=["innerHTML"],Bt={class:"font-bold"},Ht=["innerHTML"],At={class:"grid grid-cols-4 gap-2 items-start border-b pb-2 mb-2"},Et={class:"col-span-1 flex flex-col items-center"},qt={class:"text-xs text-gray-600"},Gt={class:"col-span-3"},Qt={class:"w-full text-left text-sm"},Yt={class:"py-1"},Jt={class:"text-xs text-gray-600"},Kt={class:"py-1"},Xt={class:"py-1"},Zt={class:"text-center font-semibold text-sm mt-4"},te={class:"flex justify-center mt-4"},ee={key:0,class:"flex justify-center items-center mt-6 md:mt-0"},se=["src"],de={__name:"Shipment",setup(oe){const i=Q(),P=J(),U=p(()=>i.state.User.order.data),D=p(()=>i.state.User.cancel.data);p(()=>i.state.User.refund.data);const j=p(()=>i.state.User.print.data),f=p(()=>i.state.User.order.image),l=u(null),c=u("orders"),T=p(()=>{var o;return((o=i.state.userData.data)==null?void 0:o.user)||{}});function M(){i.dispatch("User/getOrderList")}m(()=>{M()});function R(){i.dispatch("User/getImage")}m(()=>{R()});const N=o=>{l.value=o,i.dispatch("User/getImage",o.id)},y=[{id:"Order placed",label:"Order placed",icon:"hugeicons:package-process"},{id:"Waiting for courier",label:"Waiting for courier",icon:"ic:outline-local-shipping"},{id:"In transit",label:"In transit",icon:"la:shipping-fast"},{id:"Order delivered",label:"Order delivered",icon:"hugeicons:package-receive"}],F=o=>{if(!l.value)return"bg-gray-300";const s=y.map(b=>b.id.toLowerCase()),e=s.indexOf(l.value.status.toLowerCase()),d=s.indexOf(o.toLowerCase());return d<e?"bg-green-500":d===e?"bg-[#608C54]":"bg-gray-300"},_=Y({id:"",status:""});async function W(){if(!l.value)return;const o=["Order placed","Waiting for courier","In transit","Order delivered"],s=o.indexOf(l.value.status);if(s===-1||s===o.length-1)return;if(o[s]==="Waiting for courier"&&!C){console.warn("Slip not downloaded yet.");return}const e=o[s+1];_.id=l.value.id,_.status=e,await i.dispatch("User/updateStatus",_).then(d=>{d.isSuccess&&(l.value.status=e)}).catch(d=>{console.error("Error updating status:",d)})}function V(){i.dispatch("User/getCancelList")}m(()=>{V()});const $=o=>{l.value=o};u(!1),u(null);function z(){i.dispatch("User/getRefundList")}m(()=>{z()});function B(o){i.dispatch("User/getPrintList",o)}m(()=>{B()});const k=u(!1),C=u(!1);function H(){k.value=!1}u(!1);const A=()=>{const o=document.querySelector(".packing-slip-modal-content");if(!o){console.error("Modal content not found");return}Z(o).then(s=>{const e=s.toDataURL("image/png"),d=new X,S=210-40,G=s.height*S/s.width;d.addImage(e,"PNG",20,20,S,G),d.save("packing-slip.pdf"),C.value=!0,H()})},w=u(!1),E=()=>{w.value=!w.value},q=async()=>{try{(await i.dispatch("logout")).isSuccess&&P.push({name:"Login"})}catch(o){console.error("Logout error:",o)}};return(o,s)=>(r(),n("div",tt,[t("div",et,[t("header",st,[s[5]||(s[5]=t("h1",{class:"text-lg sm:text-xl 2xl:ml-0 md:ml-10 2xs:ml-10 font-bold"},"Shipment",-1)),t("div",ot,[t("div",at,[t("div",lt,[t("img",{src:T.value.avatar,alt:"Profile",class:"w-10 h-10 rounded-full object-cover shadow-md"},null,8,nt),L(I(O),{icon:"uil:setting",width:"24",height:"24",class:"cursor-pointer text-white",onClick:E})]),w.value?(r(),n("div",rt,[s[4]||(s[4]=t("a",{href:"/seller-profile",class:"block px-4 py-2 text-sm text-black hover:bg-gray-100"}," Account Info ",-1)),t("button",{onClick:q,class:"block w-full text-left px-4 py-2 text-sm text-black hover:bg-gray-100"}," Logout ")])):g("",!0)])])]),t("div",dt,[l.value?(r(),n("div",{key:1,class:v(["p-5 border-2 rounded-md mt-2 text-center flex flex-col md:flex-row items-center md:items-start",{"border-blue-300":l.value.status==="Order","border-red-300 text-red-600":l.value.status==="Cancelled","border-yellow-300 text-yellow-600":l.value.status==="Refund","border-[#608C54]":l.value.status!=="Order"&&l.value.status!=="Cancelled"&&l.value.status!=="Refund"}])},[t("div",St,[t("h1",Lt,a(l.value.status)+" Shipment",1),t("p",It,a(l.value.status==="Order"?"This shipment is currently being processed.":l.value.status==="Cancelled"?"This shipment has been cancelled. Contact customer support for assistance.":l.value.status==="Refund"?"You should receive the refund in your account shortly.":"Tracking Details"),1),l.value.status!=="Cancelled"&&l.value.status!=="Refund"?(r(),n("div",Ot,[t("div",Pt,[s[9]||(s[9]=t("div",{class:"absolute w-3/4 md:w-[430px] h-1 bg-[#608C54] top-1/2 z-0"},null,-1)),t("div",Ut,[(r(),n(h,null,x(y,e=>t("div",{key:e.id,class:v(["w-12 h-12 md:w-16 md:h-16 rounded-full flex items-center justify-center",F(e.id)])},[L(I(O),{icon:e.icon,class:"text-white w-6 h-6 md:w-8 md:h-8"},null,8,["icon"])],2)),64))])]),t("div",Dt,[(r(),n(h,null,x(y,e=>t("span",{key:e.id},a(e.label),1)),64))]),t("div",jt,[k.value?(r(),n("div",Tt,[t("div",Mt,[t("div",Rt,[(r(!0),n(h,null,x(j.value,e=>(r(),n("div",{key:e.id,class:"bg-white p- border border-gray-400 rounded-lg text-sm font-sans"},[s[14]||(s[14]=K('<div class="flex justify-between items-center border-b pb-2 mb-2"><div class="flex items-center gap-2"><div><h1 class="text-lg font-bold text-green-700">Pagsasaka</h1><p class="text-xs text-gray-600">Farmers &amp; Consumer</p></div></div><div class="text-right"><p class="font-semibold text-lg">Logistics Logo</p></div></div>',1)),t("div",Nt,[t("p",Ft,"Product Name: "+a(e.orderId),1),t("p",Wt,a(e.orderId),1)]),t("div",Vt,[t("div",null,[s[10]||(s[10]=t("p",{class:"font-semibold border-b pb-1"},"Buyer",-1)),t("p",$t,a(e.name),1),t("p",{innerHTML:e.address},null,8,zt)]),t("div",null,[s[11]||(s[11]=t("p",{class:"font-semibold border-b pb-1"},"Seller",-1)),t("p",Bt,a(e.name),1),t("p",{innerHTML:e.address},null,8,Ht)])]),t("div",At,[t("div",Et,[t("p",qt,a(e.orderId),1)]),t("div",Gt,[t("table",Qt,[s[13]||(s[13]=t("thead",null,[t("tr",{class:"border-b"},[t("th",{class:"py-1"},"Product (Qty)"),t("th",{class:"py-1"},"Price"),t("th",{class:"py-1"},"Total")])],-1)),t("tbody",null,[(r(!0),n(h,null,x(o.order.items,(d,b)=>(r(),n("tr",{key:b},[t("td",Yt,[t("strong",null,a(d.name),1),s[12]||(s[12]=t("br",null,null,-1)),t("span",Jt,"Variants: "+a(d.variant),1)]),t("td",Kt,"₱"+a(d.price.toFixed(2)),1),t("td",Xt,"₱"+a((d.price*d.quantity).toFixed(2)),1)]))),128))])])])]),t("div",Zt," Order ID: "+a(o.order.orderId),1)]))),128))]),t("div",{class:"mt-4 text-center"},[t("button",{onClick:A,class:"py-2 px-4 rounded-md bg-green-700 text-white"}," Download Packing Slip as PDF ")])])])):g("",!0)]),t("div",te,[t("button",{onClick:s[2]||(s[2]=e=>W()),class:"px-12 py-2 text-sm font-semibold rounded-lg shadow-md transition text-white bg-green-600 hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed"},"Approve")])])):g("",!0),t("button",{class:"mt-4 px-4 py-2 bg-gray-300 font-semibold rounded-lg shadow-md text-sm",onClick:s[3]||(s[3]=e=>l.value=null)}," Back to Shipments ")]),f.value&&f.value.delivery_proof?(r(),n("div",ee,[t("img",{src:f.value.delivery_proof,alt:"Shipment Image",class:"border border-gray-500 w-[280px] h-[300px] md:w-[350px] md:h-[400px] rounded-lg shadow-md object-cover"},null,8,se)])):g("",!0)],2)):(r(),n("div",it,[t("div",ct,[t("button",{class:v(["px-4 py-2 rounded transition",{"bg-blue-500 text-white":c.value==="orders","bg-gray-200":c.value!=="orders"}]),onClick:s[0]||(s[0]=e=>c.value="orders")}," My Orders",2),t("button",{class:v(["px-4 py-2 rounded transition",{"bg-red-500 text-white":c.value==="cancellations","bg-gray-200":c.value!=="cancellations"}]),onClick:s[1]||(s[1]=e=>c.value="cancellations")}," Cancellations",2)]),t("div",null,[c.value==="orders"?(r(),n("table",ut,[s[6]||(s[6]=t("thead",null,[t("tr",{class:"bg-gray-300"},[t("th",{class:"px-4 py-2"},"Name"),t("th",{class:"px-4 py-2"},"Created"),t("th",{class:"px-4 py-2"},"Last Updated"),t("th",{class:"px-4 py-2"},"Ship To"),t("th",{class:"px-4 py-2"},"Status")])],-1)),t("tbody",null,[(r(!0),n(h,null,x(U.value,e=>(r(),n("tr",{key:e.id,class:"even:bg-gray-50 hover:bg-gray-200 text-center text-sm cursor-pointer",onClick:d=>N(e)},[t("td",gt,a(e.product_name),1),t("td",ht,a(e.created_at),1),t("td",xt,a(e.updated_at),1),t("td",mt,a(e.ship_to),1),t("td",bt,a(e.status),1)],8,pt))),128))])])):g("",!0)]),t("div",null,[c.value==="cancellations"?(r(),n("table",vt,[s[7]||(s[7]=t("thead",null,[t("tr",{class:"bg-gray-300"},[t("th",{class:"px-4 py-2"},"Name"),t("th",{class:"px-4 py-2"},"Created"),t("th",{class:"px-4 py-2"},"Last Updated"),t("th",{class:"px-4 py-2"},"Ship To"),t("th",{class:"px-4 py-2"},"Status")])],-1)),t("tbody",null,[(r(!0),n(h,null,x(D.value,e=>(r(),n("tr",{key:e.id,class:"even:bg-gray-50 hover:bg-gray-200 text-center text-sm cursor-pointer",onClick:d=>$(e)},[t("td",yt,a(e.product_name),1),t("td",_t,a(e.created_at),1),t("td",wt,a(e.updated_at),1),t("td",kt,a(e.ship_to),1),t("td",Ct,a(e.status),1)],8,ft))),128))])])):g("",!0)]),s[8]||(s[8]=t("div",{class:"p-5 border-2 border-gray-300 rounded-md mt-2 text-center"},[t("h1",{class:"text-lg font-bold"},"Select a Shipment"),t("p",{class:"text-sm"},"Please select a shipment from the table to view tracking details.")],-1))]))])])]))}};export{de as default};
