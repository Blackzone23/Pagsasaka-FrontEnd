import{A as p,i as he,g as S,f as x,D as F,c as r,E as V,l as h,a as i,b as e,F as _,h as D,d as ge,u as d,t as a,e as g,I as f,k as N,G as I,r as fe,w as R,J as z,j as xe,o as l}from"./index-C5S-bgrH.js";import{L as pe,T as ve}from"./Toast-DqQXjnrE.js";import{_ as be}from"./Market_NavBar-HoyHLetK.js";import{B as ye}from"./BaseLabel-C59Oxr2m.js";import{_ as we}from"./BaseSearchField-BkXqxD8d.js";import{_ as _e}from"./Footer-NdTBoFWK.js";import{c as U,r as W,u as Ce,B as O}from"./BaseError-1qdqRqB1.js";import"./lodash--lEwg-Zm.js";/* empty css                                                              */const ke="/assets/MVegetable-DCNAYixI.png",Me={class:"p-5"},Se={class:"flex flex-wrap gap-6"},De={class:"w-full md:w-1/2 flex justify-center"},Ne=["src"],$e={class:"w-full md:w-1/2 mt-5"},je={class:"mt-2 text-sm md:text-base"},Ve={class:"text-lg font-semibold text-black"},Re={class:"mt-3"},Ae={class:"text-lg"},Be={class:"flex items-center space-x-4 mt-3"},Te={class:"flex items-center border border-gray-300 rounded-full p-1"},Le={class:"font-bold mx-4"},Pe={class:"flex flex-wrap gap-3 items-center mt-4"},qe=["onClick"],Ee=["onClick"],Fe={class:"p-4"},Ie={class:"h-full p-5 flex flex-col md:flex-row items-center border-2 border-gray-300 rounded-md space-y-5 md:space-y-0 md:space-x-5 w-full"},ze={class:"flex flex-col md:flex-row items-center space-x-3 w-full md:w-auto"},Ue=["src"],We={class:"flex flex-col text-md text-gray-600 text-center md:text-left"},Oe={class:"font-semibold"},Ye={class:"text-xs"},He={class:"mt-3 flex flex-wrap gap-2 justify-center md:justify-start"},Je={href:"/shop",class:"flex items-center gap-1 px-4 py-2 bg-white text-sm font-medium rounded-lg hover:bg-gray-300 transition border border-gray-300"},Qe={class:"p-4"},Ge={class:"border-2 border-gray-300 p-4 rounded-md"},Ke={class:"text-lg font-semibold"},Xe={class:"text-5xl"},Ze={class:"flex items-center gap-4"},et=["src"],tt={class:"font-bold"},st={class:"text-sm text-gray-500"},ot={class:"mt-2 text-gray-700"},at={class:"space-x-4"},lt={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 flex justify-center items-center"},nt={class:"bg-white p-6 rounded-md w-96"},rt={class:"p-4"},it={key:0,class:"fixed bottom-4 right-4 2xl:w-[900px] 2xs:w-[470px] 2xl:h-[85vh] 2xs:h-[65vh] bg-white rounded-lg shadow-lg flex flex-col border z-50"},dt={class:"p-4 border-b rounded-sm bg-gray-100 flex justify-between items-center"},ct={class:"flex flex-1 overflow-hidden"},ut={class:"w-1/3 bg-white border-r border-gray-300 p-4 flex flex-col"},mt={class:"flex"},ht={class:"mt-3 flex-1 overflow-auto"},gt=["onClick"],ft=["src"],xt={class:"flex-1"},pt={class:"font-semibold"},vt={class:"text-xs text-gray-500 truncate"},bt={key:0,class:"text-xs bg-red-500 text-white px-2 py-1 rounded-full"},yt=["onClick"],wt={key:1,class:"fixed inset-0 bg-gray-500 bg-opacity-75 flex justify-center items-center z-50"},_t={class:"bg-white p-6 rounded shadow-lg w-96"},Ct={class:"flex justify-around mt-4"},kt={class:"w-full flex flex-col"},Mt={key:0,class:"flex-1 flex items-center justify-center text-gray-400"},St={key:1,class:"flex flex-col flex-1"},Dt={class:"p-4 border-b text-lg font-bold flex justify-between items-center bg-gray-100"},Nt={class:"flex-1 bg-gray-50 p-4 overflow-auto space-y-4 2xl:text-sm 2xs:text-sm max-h-[400px]"},$t=["src"],jt={class:"text-xs"},Vt={key:1,class:"w-8 h-8 rounded-full bg-gray-300"},Rt={class:"p-4 border-t bg-white flex items-center"},Wt={__name:"Market_Page1",setup(At){const n=he(),Y=xe(),H=p(()=>n.state.showLoading.state),J=p(()=>n.state.Consumer.productItem.productItemInfo),Q=p(()=>n.state.Consumer.ratings.data),A=p(()=>n.state.Consumer.conversation.data),B=p(()=>n.state.Consumer.message.data);function T(){n.dispatch("Consumer/getItemListInfo",sessionStorage.getItem("ItemInfo"))}S(()=>{T()});const v=x(1),G=()=>{v.value++},K=()=>{v.value>1&&v.value--},X=async o=>{try{await n.dispatch("Consumer/getAddToCart",{id:o,quantity:v.value})}catch(t){console.error("Error adding to cart:",t)}},Z=async o=>{try{await n.dispatch("Consumer/getBuyNow",{id:o,quantity:v.value});const t=n.state.Consumer.cartItem.data.find(c=>c.id===o);t&&(t.selected=!0),Y.push("/cart")}catch(t){console.error("Error adding to checkout:",t)}},L=F({name:"Janromil Dela Cruz",lastActive:new Date(Date.now()-5*60*1e3)}),ee=p(()=>{const o=new Date,t=new Date(L.lastActive),c=o-t,s=Math.floor(c/(1e3*60)),m=Math.floor(c/(1e3*60*60));return s<1?"Active now":s<60?`${s} minutes ago`:m<24?`${m} hours ago`:`${Math.floor(m/24)} days ago`}),C=x(!1),u=x(null),$=x(""),te=()=>{u.value=null},se=()=>{C.value=!0},oe=()=>{C.value=!1},ae=o=>{console.log("Selected chat ID: ",o);const t=A.value.find(c=>c.id===o);u.value=t,n.dispatch("Consumer/getMessages",o)},le=async()=>{if(!$.value.trim()||!u.value)return;const o={conversation_id:u.value.id,message:$.value};try{await n.dispatch("Consumer/sendMessage",o),await n.dispatch("Consumer/getMessages",u.value.id),$.value=""}catch(t){console.error("Failed to send message:",t)}},ne=async()=>{try{C.value=!0;const t=await n.dispatch("Consumer/startChatWithShop","YOUR_SHOP_ID_HERE"),c={id:t.data.id,chat_partner_name:t.data.chat_partner_name,chat_partner_avatar:t.data.chat_partner_avatar};u.value=c,messageData.conversation_id=c.id,await n.dispatch("Consumer/getConversation"),await n.dispatch("Consumer/getMessages",c.id)}catch(o){console.error("Failed to start chat:",o)}};function P(){n.dispatch("Consumer/getConversation")}S(()=>{P()});const j=x(!1),k=x(!1),re=()=>{j.value=!0},q=()=>{j.value=!1},b=F({rating:3,comment:""}),ie=p(()=>({rating:{required:U.withMessage("Rating is required",W)},comment:{required:U.withMessage("Comment is required",W)}})),w=Ce(ie,b);async function de(){const o=await w.value.$validate();console.log("Validation result:",o),o&&await n.dispatch("Consumer/createComment",b).then(t=>{t.isSuccess===!0&&(q(),E())})}function E(){n.dispatch("Consumer/getRating")}S(()=>{E()}),S(()=>{window.scrollTo(0,0),T()});const M=x(!1),y=x(null),ce=(o,t)=>{t.stopPropagation(),M.value=!0,y.value=o},ue=o=>{o.stopPropagation(),M.value=!1,y.value=null},me=async()=>{var o;if(y.value)try{await n.dispatch("Consumer/deleteConversation",y.value),M.value=!1,y.value=null,P(),((o=u.value)==null?void 0:o.id)===y.value&&(u.value=null,B.value=[])}catch(t){console.error("Failed to delete conversation:",t)}};return(o,t)=>{const c=fe("n-rate");return l(),r(_,null,[H.value?(l(),V(pe,{key:0,class:"loading"})):h("",!0),i(ve),e("div",null,[i(be),e("div",Me,[e("div",Se,[(l(!0),r(_,null,D(J.value,s=>(l(),r("div",{key:s.id,class:"flex flex-col md:flex-row w-full border-2 border-gray-300 p-5 rounded-md"},[e("div",De,[e("img",{src:s.product_img[0],alt:"Product Image",class:"rounded-lg shadow-lg w-full max-w-md h-auto md:h-[400px]"},null,8,Ne)]),e("div",$e,[i(ye,{class:"text-2xl md:text-4xl font-bold"},{default:R(()=>[g(a(s.product_name),1)]),_:2},1024),e("div",je,[e("p",Ve,"₱"+a(s.price),1),t[11]||(t[11]=e("p",{class:"mt-2"},"Free & Easy Returns Enjoy Free Return",-1)),e("div",Re,[t[7]||(t[7]=e("h1",{class:"font-bold text-lg"},"Shipping",-1)),e("div",Ae,[e("p",null,[t[5]||(t[5]=e("span",{class:"font-semibold"},"Stock:",-1)),g(" "+a(s.stocks),1)]),e("p",null,[t[6]||(t[6]=e("span",{class:"font-semibold"},"Unit:",-1)),g(" "+a(s.unit),1)])])]),e("div",Be,[t[8]||(t[8]=e("h2",{class:"font-bold text-lg"},"Quantity:",-1)),e("div",Te,[e("button",{onClick:K},[i(d(f),{icon:"zondicons:minus-solid",width:"20",height:"20",style:{color:"#608C54"}})]),e("span",Le,a(v.value),1),e("button",{onClick:G},[i(d(f),{icon:"gridicons:add",width:"24",height:"24",style:{color:"#608C54"}})])])]),e("div",Pe,[e("button",{onClick:m=>X(s.id),class:"bg-[#608C54] text-white font-bold px-4 py-2 hover:bg-[#4e7343] rounded flex items-center gap-2"},[i(d(f),{icon:"lineicons:cart-2",width:"24",height:"24",style:{color:"#fff"}}),t[9]||(t[9]=g(" Add to Cart "))],8,qe),e("button",{onClick:m=>Z(s.id),class:"bg-[#608C54] text-white font-bold py-2 px-5 rounded hover:bg-[#4e7343] flex items-center gap-2"},[i(d(f),{icon:"icon-park-twotone:buy",width:"24",height:"24",style:{color:"#fff"}}),t[10]||(t[10]=g(" Buy Now "))],8,Ee)])])])]))),128))])]),e("div",Fe,[e("div",Ie,[e("div",ze,[e("img",{src:d(ke),alt:"Placeholder Image",class:"w-16 h-16 rounded-full border border-gray-500"},null,8,Ue),e("div",We,[e("span",Oe,a(L.name),1),e("span",Ye,a(ee.value),1),e("div",He,[e("button",{onClick:ne,class:"flex items-center gap-1 px-4 py-2 bg-[#608C54] text-white text-sm font-medium rounded-lg hover:bg-green-700 transition"},[i(d(f),{icon:"mdi:chat",width:"20",height:"20",style:{color:"white"}}),t[12]||(t[12]=g(" Chat Now "))]),e("a",Je,[i(d(f),{icon:"bx:store",width:"20",height:"20",style:{color:"black"}}),t[13]||(t[13]=g(" View Shop "))])])])]),t[14]||(t[14]=ge('<div class="hidden md:block border-l border-gray-300 h-20"></div><div class="w-full md:flex-1 grid grid-cols-2 md:grid-cols-4 gap-4 items-center text-gray-600 text-center"><div class="flex flex-col items-center"><h1 class="text-md font-semibold">Rating</h1><span class="text-xs">4.5</span></div><div class="flex flex-col items-center"><h1 class="text-md font-semibold">Products</h1><span class="text-xs">2</span></div><div class="flex flex-col items-center"><h1 class="text-md font-semibold">Joined</h1><span class="text-xs">4 months ago</span></div><div class="flex flex-col items-center"><h1 class="text-md font-semibold">Followers</h1><span class="text-xs">123</span></div></div>',2))])]),t[19]||(t[19]=e("div",{class:"p-5"},[e("div",{class:"border-2 p-5 border-gray-300 rounded-md"},[e("h1",{class:"text-lg font-semibold"},"Product Description"),e("p",{class:"text-md leading-relaxed"}," Our Salad Pack is packed with fiber and essential nutrients—quick and easy to prepare. Whether you’re a busy professional, a fitness enthusiast, or just someone looking to make healthy eating more convenient, this pack is designed to simplify your life without compromising nutrition. ")])],-1)),e("div",Qe,[e("div",Ge,[e("h2",Ke,"Total Reviews: "+a(o.total_ratings),1),e("div",Xe,a(o.average_rating),1),e("div",{class:N([k.value?"max-h-96 overflow-y-auto":"","mt-4"])},[(l(!0),r(_,null,D(Q.value,s=>(l(),r("div",{key:s.id,class:"p-4 border-2 border-gray-300 rounded-md"},[e("div",Ze,[e("img",{src:s.image,alt:"",class:"w-12 h-12 rounded-full object-cover"},null,8,et),e("div",null,[i(c,{"allow-half":"",readonly:"","default-value":s.rating,size:"small"},null,8,["default-value"]),e("h3",tt,a(s.name),1),e("p",st,a(o.rating.date),1)])]),e("p",ot,a(s.comment),1)]))),128))],2),e("div",at,[e("button",{onClick:t[0]||(t[0]=s=>k.value=!k.value),class:"bg-[#608C54] text-white py-2 px-4 rounded shadow hover:bg-green-700 transition mt-2"},a(k.value?"Collapse Reviews":"See More Reviews"),1),e("button",{onClick:re,class:"bg-gray-700 text-white py-2 px-4 rounded shadow hover:bg-gray-600 transition mt-4"}," Add New Comment ")])]),j.value?(l(),r("div",lt,[e("div",nt,[t[15]||(t[15]=e("h2",{class:"text-lg font-semibold mb-4"},"Add Your Review",-1)),i(c,{modelValue:b.rating,"onUpdate:modelValue":t[1]||(t[1]=s=>b.rating=s),"allow-half":"",size:"large",class:"mb-4"},null,8,["modelValue"]),d(w).rating.$error?(l(),V(O,{key:0},{default:R(()=>[g(a(d(w).rating.$errors[0].$message),1)]),_:1})):h("",!0),I(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=s=>b.comment=s),placeholder:"Write your comment...",rows:"4",class:"w-full border-2 border-gray-300 p-2 rounded-md"},null,512),[[z,b.comment]]),d(w).comment.$error?(l(),V(O,{key:1},{default:R(()=>[g(a(d(w).comment.$errors[0].$message),1)]),_:1})):h("",!0),e("div",{class:"mt-4 flex gap-2"},[e("button",{onClick:de,class:"bg-green-800 text-white py-2 px-4 rounded shadow hover:bg-green-600 transition"},"Submit"),e("button",{onClick:q,class:"bg-red-800 text-white py-2 px-4 rounded shadow hover:bg-red-600 transition"},"Cancel")])])])):h("",!0)]),e("div",rt,[e("button",{onClick:se,class:"hidden md:flex bg-yellow-100 border-2 border-gray-300 rounded-full p-3 fixed bottom-4 right-4 shadow-md hover:bg-yellow-300 items-center justify-center"},[i(d(f),{icon:"tabler:message",width:"28",height:"28",style:{color:"#608C54"}})])]),C.value?(l(),r("div",it,[e("div",dt,[t[16]||(t[16]=e("span",{class:"text-xl font-bold text-green-600"},"Chat",-1)),e("button",{onClick:oe,class:"text-gray-600 text-lg"},[i(d(f),{icon:"icon-park-solid:close-one",width:"20",height:"20"})])]),e("div",ct,[e("div",ut,[e("div",mt,[i(we,{placeholder:"Search...",class:"2xl:w-[270px] 2xs:w-[137px]"})]),e("div",ht,[(l(!0),r(_,null,D(A.value,s=>(l(),r("div",{key:s.id,class:"flex items-center p-3 border-b cursor-pointer hover:bg-gray-100 transition duration-200",onClick:m=>ae(s.id)},[e("img",{src:s.chat_partner_avatar,class:"w-12 h-12 rounded-full border mr-3",alt:"Avatar"},null,8,ft),e("div",xt,[e("span",pt,a(s.chat_partner_name),1),e("p",vt,a(s.message),1)]),s.unread_messages_count?(l(),r("span",bt,a(s.unread_messages_count),1)):h("",!0),e("button",{class:"text-white rounded",onClick:m=>ce(s.id,m)},[i(d(f),{icon:"mdi-light:delete",width:"20",height:"20",style:{color:"#ad1414"}})],8,yt),M.value?(l(),r("div",wt,[e("div",_t,[t[17]||(t[17]=e("h3",{class:"text-xl font-semibold text-center"},"Are you sure you want to delete this conversation?",-1)),e("div",Ct,[e("button",{onClick:me,class:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700"},"Yes, Delete"),e("button",{onClick:t[3]||(t[3]=m=>ue(m)),class:"px-4 py-2 bg-gray-300 text-gray-800 rounded hover:bg-gray-400"},"Cancel")])])])):h("",!0)],8,gt))),128))])]),e("div",kt,[u.value?(l(),r("div",St,[e("div",Dt,[e("span",null,a(u.value.chat_partner_name),1),e("button",{onClick:te,class:"text-gray-500"},"Close")]),e("div",Nt,[(l(!0),r(_,null,D(B.value,s=>(l(),r("div",{key:s.id,class:N(["flex items-start space-x-3",{"justify-end":s.sender.id===o.userName,"justify-start":s.sender.id!==o.userName}])},[s.sender.id!==o.userName?(l(),r("img",{key:0,src:s.sender.avatar||o.defaultAvatar,class:"w-8 h-8 rounded-full"},null,8,$t)):h("",!0),e("div",{class:N(["p-3 rounded-lg shadow-md w-auto max-w-xs",{"bg-green-500 text-white ":s.sender.id===o.userName,"bg-gray-200 text-black":s.sender.id!==o.userName}])},[e("p",{class:N(["text-sm font-bold",{"text-white":s.sender.id===o.userName,"text-green-600":s.sender.id!==o.userName}])},a(s.sender.first_name)+" "+a(s.sender.last_name),3),e("p",jt,a(s.message),1)],2),s.sender.id===o.userName?(l(),r("div",Vt)):h("",!0)],2))),128))]),e("div",Rt,[I(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>o.messageData.message=s),type:"text",placeholder:"Type a message here",class:"flex-1 p-2 border rounded-md text-sm"},null,512),[[z,o.messageData.message]]),e("button",{class:"ml-2 bg-green-600 text-white px-4 py-2 rounded-md transition duration-200 hover:bg-green-700",onClick:le}," Send ")])])):(l(),r("div",Mt,t[18]||(t[18]=[e("p",{class:"text-xl"},"Welcome to Pagsasaka Chat",-1)])))])])])):h("",!0)]),i(_e)],64)}}};export{Wt as default};
