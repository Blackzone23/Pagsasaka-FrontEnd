import{B as u}from"./BaseLabel-CAfMs-xT.js";import{_ as p}from"./BaseInputField-WsJZfwXa.js";import{L as T,T as O}from"./Toast-l2ljLstt.js";import"./lodash-sk5RwdSA.js";import{A as W,i as Y,D as j,f as b,c as h,E as $,l as _,a as l,b as t,u as y,I as k,t as w,w as m,F as q,j as G,o as v,e as c}from"./index-CZyWb1aQ.js";/* empty css                                                              */const H={class:"h-screen bg-gray-300"},J={class:"bg-[#285a19] shadow p-4 flex justify-between items-center text-white"},K={class:"relative inline-block text-left"},Q={class:"flex items-center space-x-2"},X=["src"],Z={key:0,class:"absolute right-0 z-50 mt-2 w-48 bg-white rounded shadow-lg"},ee={class:"w-full flex justify-center px-4 py-20"},te={class:"2xs:w-full 2xl:w-1/2 md:w-1/2 max-w-4xl p-6 bg-white shadow-lg rounded-lg"},se={class:"flex flex-col items-center"},ae={class:"relative cursor-pointer"},oe=["src"],le={class:"absolute bottom-0 right-0 bg-white p-1 rounded-full shadow"},re={class:"mt-4 text-lg sm:text-xl font-semibold"},ne={class:"text-gray-600 text-sm sm:text-base"},ie={class:"text-gray-600 text-sm sm:text-base"},de={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center px-4 z-50"},ue={class:"bg-white p-6 rounded-lg shadow-lg w-full max-w-md"},me={key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},ce={class:"bg-white rounded-xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto shadow-lg"},pe={class:"space-y-3"},fe={class:"relative"},be={class:"relative"},ke={__name:"Rider_Profile",setup(we){const f=Y(),U=G(),a=W(()=>{var r;return(r=f.state.userData.data)==null?void 0:r.user}),o=j({first_name:a.value.first_name||"",middle_name:a.value.middle_name||"",last_name:a.value.last_name||"",email:a.value.email||"",phone_number:a.value.phone_number||""}),I=async()=>{var r,e;try{await f.dispatch("updateProfile",{id:a.value.id,first_name:o.first_name,middle_name:o.middle_name,last_name:o.last_name,phone_number:o.phone_number,email:o.email}),a.value.first_name=o.first_name,a.value.middle_name=o.middle_name,a.value.last_name=o.last_name,a.value.phone_number=o.phone_number,a.value.email=o.email,E()}catch(s){if((e=(r=s.response)==null?void 0:r.data)!=null&&e.errors){const n=s.response.data.errors,d=Object.keys(n)[0];d&&alert(n[d][0])}else console.error("Error updating profile:",s),alert("An unexpected error occurred.")}},V=b(!1),L=()=>{V.value=!0},E=()=>{V.value=!1},i=j({password:a.value.password||"",password_confirmation:a.value.password_confirmation||""}),g=b(!1),N=()=>{g.value=!g.value},x=b(!1),A=()=>{x.value=!x.value},P=b(!1),B=()=>{P.value=!0},R=()=>{P.value=!1},F=async()=>{var r,e;try{if(i.password!==i.password_confirmation){alert("Passwords do not match");return}await f.dispatch("updatePassword",{id:a.value.id,password:i.password,password_confirmation:i.password_confirmation}),R(),i.password="",i.password_confirmation=""}catch(s){if((e=(r=s.response)==null?void 0:r.data)!=null&&e.errors){const n=s.response.data.errors,d=Object.keys(n)[0];d&&alert(n[d][0])}else console.error("Error updating password:",s),alert("An unexpected error occurred.")}},D=j({avatar:a.value.avatar||""}),M=async r=>{const e=r.target.files[0];if(!e)return;const s=new FormData;s.append("avatar",e),s.append("id",a.value.id);try{const n=await f.dispatch("Rider/addImage",s);if(n&&n.avatar){const d=n.avatar;D.avatar=d,a.value.avatar=a.value.avatar,sessionStorage.setItem("userAvatar",d),f.commit("setAvatar",d)}}catch(n){console.error("Image upload failed:",n),alert("Image upload failed. Please try again.")}},C=b(!1),S=()=>{C.value=!C.value},z=async()=>{try{(await f.dispatch("logout")).isSuccess&&U.push({name:"Login"})}catch(r){console.error("Logout error:",r)}};return(r,e)=>(v(),h(q,null,[r.showLoading?(v(),$(T,{key:0,class:"loading"})):_("",!0),l(O),t("div",H,[t("header",J,[e[8]||(e[8]=t("h1",{class:"text-lg sm:text-xl 2xl:ml-0 md:ml-10 2xs:ml-10 font-bold"},"Welcome to Rider Profile",-1)),t("div",K,[t("div",Q,[t("img",{src:a.value.avatar,alt:"Profile",class:"w-10 h-10 rounded-full object-cover shadow-md"},null,8,X),l(y(k),{icon:"uil:setting",width:"24",height:"24",class:"cursor-pointer text-white",onClick:S})]),C.value?(v(),h("div",Z,[e[7]||(e[7]=t("a",{href:"/rider_profile",class:"block px-4 py-2 text-sm text-black hover:bg-gray-100"}," Account Info ",-1)),t("button",{onClick:z,class:"block w-full text-left px-4 py-2 text-sm text-black hover:bg-gray-100"}," Logout ")])):_("",!0)])]),t("div",ee,[t("div",te,[t("div",se,[t("label",ae,[t("input",{type:"file",accept:"image/*",class:"hidden",onChange:M},null,32),t("img",{src:D.avatar,alt:"Profile",class:"w-32 h-32 rounded-full object-cover border-4 border-white shadow-md hover:opacity-80 transition duration-200"},null,8,oe),t("div",le,[l(y(k),{icon:"ic:twotone-plus",width:"24",height:"24",style:{color:"#9faba4"}})])]),t("h2",re,w(a.value.first_name)+" "+w(a.value.middle_name)+" "+w(a.value.last_name),1),t("p",ne,w(a.value.email),1),t("p",ie,w(a.value.phone_number),1),t("div",{class:"flex flex-col sm:flex-row justify-center mt-8 gap-4 text-sm"},[t("button",{onClick:L,class:"px-6 py-2 rounded-full bg-green-800 text-white hover:bg-green-600 transition"},"Edit Profile"),t("button",{onClick:B,class:"px-6 py-2 rounded-full bg-red-700 text-white hover:bg-red-500 transition"},"Change Password")])])])]),V.value?(v(),h("div",de,[t("div",ue,[l(u,{class:"text-xl font-semibold mb-4"},{default:m(()=>e[9]||(e[9]=[c("Edit Profile")])),_:1}),l(u,{class:"block mb-2"},{default:m(()=>e[10]||(e[10]=[c("First Name")])),_:1}),l(p,{modelValue:o.first_name,"onUpdate:modelValue":e[0]||(e[0]=s=>o.first_name=s),class:"w-full p-2 border rounded mb-4",type:"text"},null,8,["modelValue"]),l(u,{class:"block mb-2"},{default:m(()=>e[11]||(e[11]=[c("Middle Name")])),_:1}),l(p,{modelValue:o.middle_name,"onUpdate:modelValue":e[1]||(e[1]=s=>o.middle_name=s),class:"w-full p-2 border rounded mb-4",type:"text"},null,8,["modelValue"]),l(u,{class:"block mb-2"},{default:m(()=>e[12]||(e[12]=[c("Last Name")])),_:1}),l(p,{modelValue:o.last_name,"onUpdate:modelValue":e[2]||(e[2]=s=>o.last_name=s),class:"w-full p-2 border rounded mb-4",type:"text"},null,8,["modelValue"]),l(u,{class:"block mb-2"},{default:m(()=>e[13]||(e[13]=[c("Email")])),_:1}),l(p,{modelValue:o.email,"onUpdate:modelValue":e[3]||(e[3]=s=>o.email=s),class:"w-full p-2 border rounded mb-4",type:"email"},null,8,["modelValue"]),l(u,{class:"block mb-2"},{default:m(()=>e[14]||(e[14]=[c("Phone")])),_:1}),l(p,{modelValue:o.phone_number,"onUpdate:modelValue":e[4]||(e[4]=s=>o.phone_number=s),class:"w-full p-2 border rounded mb-4",type:"text"},null,8,["modelValue"]),t("div",{class:"flex justify-end gap-2 text-sm"},[t("button",{onClick:E,class:"bg-gray-400 text-white py-2 px-4 rounded hover:bg-gray-500"}," Cancel "),t("button",{onClick:I,class:"bg-green-800 text-white py-2 px-4 rounded hover:bg-green-600"}," Save ")])])])):_("",!0),P.value?(v(),h("div",me,[t("div",ce,[e[17]||(e[17]=t("h2",{class:"text-lg font-semibold mb-4"},"Change Password",-1)),t("div",pe,[t("div",fe,[l(u,{class:"font-semibold"},{default:m(()=>e[15]||(e[15]=[c("*New Password")])),_:1}),l(p,{modelValue:i.password,"onUpdate:modelValue":e[5]||(e[5]=s=>i.password=s),type:g.value?"text":"password",placeholder:"Enter Your Password",class:"w-full"},null,8,["modelValue","type"]),t("button",{type:"button",class:"absolute right-3 2xl:top-10 lg:top-10 md:top-11 2xs:top-12 text-gray-500",onClick:N},[l(y(k),{icon:g.value?"ic:twotone-visibility-off":"ic:twotone-visibility"},null,8,["icon"])])]),t("div",be,[l(u,{class:"font-semibold"},{default:m(()=>e[16]||(e[16]=[c("*Re-enter Password")])),_:1}),l(p,{modelValue:i.password_confirmation,"onUpdate:modelValue":e[6]||(e[6]=s=>i.password_confirmation=s),type:x.value?"text":"password",placeholder:"Re-enter password",class:"w-full"},null,8,["modelValue","type"]),t("button",{type:"button",class:"absolute right-3 2xl:top-10 lg:top-10 md:top-11 2xs:top-12 text-gray-500",onClick:A},[l(y(k),{icon:x.value?"ic:twotone-visibility-off":"ic:twotone-visibility"},null,8,["icon"])])]),t("div",{class:"flex justify-end space-x-2 pt-2"},[t("button",{type:"button",onClick:R,class:"bg-gray-400 text-white py-2 px-4 rounded hover:bg-gray-500"}," Cancel "),t("button",{onClick:F,class:"bg-green-800 text-white py-2 px-4 rounded hover:bg-green-600"}," Save ")])])])])):_("",!0)])],64))}};export{ke as default};
