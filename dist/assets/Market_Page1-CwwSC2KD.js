import{A as _,i as ke,f,g as K,D as B,c as r,E as N,l as u,a as i,b as e,F as S,h as j,d as Me,u as c,t as a,e as p,I as x,r as Se,k as A,G as X,w as L,J as Z,j as De,o as l}from"./index-C6ga6Tkl.js";import{L as Ie,T as Re}from"./Toast-CMcD8vj2.js";import{_ as $e}from"./Market_NavBar-B-Ck46k9.js";import{B as je}from"./BaseLabel-B7hqSrQm.js";import{_ as Ae}from"./BaseSearchField-HaI1uJ6B.js";import{_ as Pe}from"./Footer-DjE1INf3.js";import{c as E,r as ee,u as Ve,B as te}from"./BaseError-J3ZXh8NN.js";import"./lodash-CrtkfJpY.js";/* empty css                                                              */const Be="/assets/MVegetable-DCNAYixI.png",Ne={class:"p-5"},Le={class:"flex flex-wrap gap-6"},Ee={class:"w-full md:w-1/2 flex justify-center"},Fe=["src"],Te={class:"w-full md:w-1/2 mt-5"},qe={class:"mt-2 text-sm md:text-base"},ze={class:"text-lg font-semibold text-black"},Ue={class:"mt-3"},We={class:"text-lg"},Oe={class:"flex items-center space-x-4 mt-3"},Ye={class:"flex items-center border border-gray-300 rounded-full p-1"},He={class:"font-bold mx-4"},Je={class:"flex flex-wrap gap-3 items-center mt-4"},Qe=["onClick"],Ge=["onClick"],Ke={class:"p-4"},Xe={class:"h-full p-5 flex flex-col md:flex-row items-center border-2 border-gray-300 rounded-md space-y-5 md:space-y-0 md:space-x-5 w-full"},Ze={class:"flex flex-col md:flex-row items-center space-x-3 w-full md:w-auto"},et=["src"],tt={class:"flex flex-col text-md text-gray-600 text-center md:text-left"},st={class:"font-semibold"},ot={class:"text-xs"},at={class:"mt-3 flex flex-wrap gap-2 justify-center md:justify-start"},lt={href:"/shop",class:"flex items-center gap-1 px-4 py-2 bg-white text-sm font-medium rounded-lg hover:bg-gray-300 transition border border-gray-300"},nt={class:"p-4"},rt={class:"border-2 border-gray-300 p-4 rounded-md"},it={class:"flex items-center gap-4"},dt={class:"text-lg font-semibold"},ct={class:"flex items-center gap-4"},ut=["src"],mt={class:"font-bold"},gt={class:"text-sm text-gray-500"},ht={class:"mt-2 text-gray-700"},ft={key:0,class:"mt-1 text-gray-500"},pt={class:"space-x-4"},xt={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 flex justify-center items-center"},vt={class:"bg-white p-6 rounded-md w-96"},_t={class:"p-4"},bt={key:0,class:"fixed bottom-4 right-4 2xl:w-[900px] 2xs:w-[470px] 2xl:h-[85vh] 2xs:h-[65vh] bg-white rounded-lg shadow-lg flex flex-col border z-50"},yt={class:"p-4 border-b rounded-sm bg-gray-100 flex justify-between items-center"},wt={class:"flex flex-1 overflow-hidden"},Ct={class:"w-1/3 bg-white border-r border-gray-300 p-4 flex flex-col"},kt={class:"flex"},Mt={class:"mt-3 flex-1 overflow-auto"},St=["onClick"],Dt=["src"],It={class:"flex-1"},Rt={class:"font-semibold"},$t={class:"text-xs text-gray-500 truncate"},jt={key:0,class:"text-xs bg-red-500 text-white px-2 py-1 rounded-full"},At=["onClick"],Pt={key:1,class:"fixed inset-0 bg-gray-500 bg-opacity-75 flex justify-center items-center z-50"},Vt={class:"bg-white p-6 rounded shadow-lg w-96"},Bt={class:"flex justify-around mt-4"},Nt={class:"w-full flex flex-col"},Lt={key:0,class:"flex-1 flex items-center justify-center text-gray-400"},Et={key:1,class:"flex flex-col flex-1"},Ft={class:"p-4 border-b text-lg font-bold flex justify-between items-center bg-gray-100"},Tt={class:"flex-1 bg-gray-50 p-4 overflow-auto space-y-4 2xl:text-sm 2xs:text-sm max-h-[400px]"},qt=["src"],zt={class:"text-xs"},Ut={key:1,class:"w-8 h-8 rounded-full bg-gray-300"},Wt={class:"p-4 border-t bg-white flex items-center"},ts={__name:"Market_Page1",setup(Ot){const n=ke(),se=De(),oe=_(()=>n.state.showLoading.state),ae=_(()=>n.state.Consumer.productItem.productItemInfo),F=_(()=>n.state.Consumer.productRatings),T=_(()=>n.state.Consumer.conversation.data),q=_(()=>n.state.Consumer.message.data),z=f("path/to/default/avatar.png"),D=f(!1),I=_(()=>{var t;const o=sessionStorage.getItem("ItemInfo");return((t=F.value)==null?void 0:t[o])||null});function le(){const o=sessionStorage.getItem("ItemInfo");n.dispatch("Consumer/getItemListInfo",o)}async function U(){var t;const o=sessionStorage.getItem("ItemInfo");o&&!((t=F.value)!=null&&t[o])&&await n.dispatch("Consumer/getProductRatings",o)}function ne(o){return new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}K(()=>{le(),U()});const b=f(1),re=()=>{b.value++},ie=()=>{b.value>1&&b.value--},de=async o=>{try{await n.dispatch("Consumer/getAddToCart",{id:o,quantity:b.value})}catch(t){console.error("Error adding to cart:",t)}},ce=async o=>{try{await n.dispatch("Consumer/getBuyNow",{id:o,quantity:b.value});const t=n.state.Consumer.cartItem.data.find(d=>d.id===o);t&&(t.selected=!0),se.push("/cart")}catch(t){console.error("Error adding to checkout:",t)}},W=B({name:"Janromil Dela Cruz",lastActive:new Date(Date.now()-5*60*1e3)}),ue=_(()=>{const o=new Date,t=new Date(W.lastActive),d=o-t,C=Math.floor(d/(1e3*60)),k=Math.floor(d/(1e3*60*60));return C<1?"Active now":C<60?`${C} minutes ago`:k<24?`${k} hours ago`:`${Math.floor(k/24)} days ago`}),R=f(!1),m=f(null),y=B({message:""}),v=f("current_user_id"),me=()=>{m.value=null},ge=()=>{R.value=!0},he=()=>{R.value=!1},fe=o=>{console.log("Selected chat ID:",o);const t=T.value.find(d=>d.id===o);m.value=t,n.dispatch("Consumer/getMessages",o)},pe=async()=>{if(!y.message.trim()||!m.value)return;const o={conversation_id:m.value.id,message:y.message};try{await n.dispatch("Consumer/sendMessage",o),await n.dispatch("Consumer/getMessages",m.value.id),y.message=""}catch(t){console.error("Failed to send message:",t)}},xe=async()=>{try{R.value=!0;const t=await n.dispatch("Consumer/startChatWithShop","YOUR_SHOP_ID_HERE"),d={id:t.data.id,chat_partner_name:t.data.chat_partner_name,chat_partner_avatar:t.data.chat_partner_avatar};m.value=d,y.conversation_id=d.id,await n.dispatch("Consumer/getConversation"),await n.dispatch("Consumer/getMessages",d.id)}catch(o){console.error("Failed to start chat:",o)}};function O(){n.dispatch("Consumer/getConversation")}K(()=>{O()});const P=f(!1),ve=()=>{g.rating=0,g.comment="",P.value=!0},Y=()=>{P.value=!1},g=B({rating:0,comment:""}),_e=_(()=>({rating:{required:E.withMessage("Please select a rating",ee),minValue:E.withMessage("Rating must be at least 1 star",o=>o>=1)},comment:{required:E.withMessage("Comment is required",ee)}})),M=Ve(_e,g);async function be(){if(await M.value.$validate())try{console.log("Submitting rating:",g.rating),await n.dispatch("Consumer/createComment",{...g,product_id:sessionStorage.getItem("ItemInfo")}),Y(),U()}catch(t){console.error("Failed to create comment:",t)}}const $=f(!1),w=f(null),ye=(o,t)=>{t.stopPropagation(),$.value=!0,w.value=o},we=o=>{o.stopPropagation(),$.value=!1,w.value=null},Ce=async()=>{var o;if(w.value)try{await n.dispatch("Consumer/deleteConversation",w.value),$.value=!1,w.value=null,O(),((o=m.value)==null?void 0:o.id)===w.value&&(m.value=null,q.value=[])}catch(t){console.error("Failed to delete conversation:",t)}};return(o,t)=>{var C,k,V,H,J;const d=Se("n-rate");return l(),r(S,null,[oe.value?(l(),N(Ie,{key:0,class:"loading"})):u("",!0),i(Re),e("div",null,[i($e),e("div",Ne,[e("div",Le,[(l(!0),r(S,null,j(ae.value,s=>(l(),r("div",{key:s.id,class:"flex flex-col md:flex-row w-full border-2 border-gray-300 p-5 rounded-md"},[e("div",Ee,[e("img",{src:s.product_img[0],alt:"Product Image",class:"rounded-lg shadow-lg w-full max-w-md h-auto md:h-[400px]"},null,8,Fe)]),e("div",Te,[i(je,{class:"text-2xl md:text-4xl font-bold"},{default:L(()=>[p(a(s.product_name),1)]),_:2},1024),e("div",qe,[e("p",ze,"₱"+a(s.price),1),t[11]||(t[11]=e("p",{class:"mt-2"},"Free & Easy Returns Enjoy Free Return",-1)),e("div",Ue,[t[7]||(t[7]=e("h1",{class:"font-bold text-lg"},"Shipping",-1)),e("div",We,[e("p",null,[t[5]||(t[5]=e("span",{class:"font-semibold"},"Stock:",-1)),p(" "+a(s.stocks),1)]),e("p",null,[t[6]||(t[6]=e("span",{class:"font-semibold"},"Unit:",-1)),p(" "+a(s.unit),1)])])]),e("div",Oe,[t[8]||(t[8]=e("h2",{class:"font-bold text-lg"},"Quantity:",-1)),e("div",Ye,[e("button",{onClick:ie},[i(c(x),{icon:"zondicons:minus-solid",width:"20",height:"20",style:{color:"#608C54"}})]),e("span",He,a(b.value),1),e("button",{onClick:re},[i(c(x),{icon:"gridicons:add",width:"24",height:"24",style:{color:"#608C54"}})])])]),e("div",Je,[e("button",{onClick:h=>de(s.id),class:"bg-[#608C54] text-white font-bold px-4 py-2 hover:bg-[#4e7343] rounded flex items-center gap-2"},[i(c(x),{icon:"lineicons:cart-2",width:"24",height:"24",style:{color:"#fff"}}),t[9]||(t[9]=p(" Add to Cart "))],8,Qe),e("button",{onClick:h=>ce(s.id),class:"bg-[#608C54] text-white font-bold py-2 px-5 rounded hover:bg-[#4e7343] flex items-center gap-2"},[i(c(x),{icon:"icon-park-twotone:buy",width:"24",height:"24",style:{color:"#fff"}}),t[10]||(t[10]=p(" Buy Now "))],8,Ge)])])])]))),128))])]),e("div",Ke,[e("div",Xe,[e("div",Ze,[e("img",{src:c(Be),alt:"Placeholder Image",class:"w-16 h-16 rounded-full border border-gray-500"},null,8,et),e("div",tt,[e("span",st,a(W.name),1),e("span",ot,a(ue.value),1),e("div",at,[e("button",{onClick:xe,class:"flex items-center gap-1 px-4 py-2 bg-[#608C54] text-white text-sm font-medium rounded-lg hover:bg-green-700 transition"},[i(c(x),{icon:"mdi:chat",width:"20",height:"20",style:{color:"white"}}),t[12]||(t[12]=p(" Chat Now "))]),e("a",lt,[i(c(x),{icon:"bx:store",width:"20",height:"20",style:{color:"black"}}),t[13]||(t[13]=p(" View Shop "))])])])]),t[14]||(t[14]=Me('<div class="hidden md:block border-l border-gray-300 h-20"></div><div class="w-full md:flex-1 grid grid-cols-2 md:grid-cols-4 gap-4 items-center text-gray-600 text-center"><div class="flex flex-col items-center"><h1 class="text-md font-semibold">Rating</h1><span class="text-xs">4.5</span></div><div class="flex flex-col items-center"><h1 class="text-md font-semibold">Products</h1><span class="text-xs">2</span></div><div class="flex flex-col items-center"><h1 class="text-md font-semibold">Joined</h1><span class="text-xs">4 months ago</span></div><div class="flex flex-col items-center"><h1 class="text-md font-semibold">Followers</h1><span class="text-xs">123</span></div></div>',2))])]),t[19]||(t[19]=e("div",{class:"p-5"},[e("div",{class:"border-2 p-5 border-gray-300 rounded-md"},[e("h1",{class:"text-lg font-semibold"},"Product Description"),e("p",{class:"text-md leading-relaxed"}," Our Salad Pack is packed with fiber and essential nutrients—quick and easy to prepare. Whether you’re a busy professional, a fitness enthusiast, or just someone looking to make healthy eating more convenient, this pack is designed to simplify your life without compromising nutrition. ")])],-1)),e("div",nt,[e("div",rt,[e("div",it,[e("h2",dt,"Total Reviews: "+a(((C=I.value)==null?void 0:C.total_ratings)||0),1),i(d,{"allow-half":"",readonly:"",value:((k=I.value)==null?void 0:k.average_rating)||0,size:"small"},null,8,["value"])]),e("div",{class:A([D.value?"max-h-96 overflow-y-auto":"","mt-4"])},[(l(!0),r(S,null,j(((H=(V=I.value)==null?void 0:V.ratings)==null?void 0:H.data)||[],s=>{var h,Q,G;return l(),r("div",{key:s.id,class:"p-4 border-2 border-gray-300 rounded-md mb-2"},[e("div",ct,[e("img",{src:((h=s.account)==null?void 0:h.avatar)||z.value,alt:"Reviewer Avatar",class:"w-12 h-12 rounded-full object-cover"},null,8,ut),e("div",null,[i(d,{"allow-half":"",readonly:"",value:s.rating,size:"small"},null,8,["value"]),e("h3",mt,a((Q=s.account)==null?void 0:Q.first_name)+" "+a((G=s.account)==null?void 0:G.last_name),1),e("p",gt,a(ne(s.created_at)),1)])]),e("p",ht,a(s.comment),1),s.seller_response?(l(),r("p",ft,"Seller: "+a(s.seller_response),1)):u("",!0)])}),128))],2),e("div",pt,[((J=I.value)==null?void 0:J.total_ratings)>0?(l(),r("button",{key:0,onClick:t[0]||(t[0]=s=>D.value=!D.value),class:"bg-[#608C54] text-white py-2 px-4 rounded shadow hover:bg-green-700 transition mt-2"},a(D.value?"Collapse Reviews":"See More Reviews"),1)):u("",!0),e("button",{onClick:ve,class:"bg-gray-700 text-white py-2 px-4 rounded shadow hover:bg-gray-600 transition mt-4"}," Add New Comment ")])]),P.value?(l(),r("div",xt,[e("div",vt,[t[15]||(t[15]=e("h2",{class:"text-lg font-semibold mb-4"},"Add Your Review",-1)),i(d,{value:g.rating,"onUpdate:value":t[1]||(t[1]=s=>g.rating=s),"allow-half":"",size:"large",class:"mb-4"},null,8,["value"]),c(M).rating.$error?(l(),N(te,{key:0},{default:L(()=>[p(a(c(M).rating.$errors[0].$message),1)]),_:1})):u("",!0),X(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=s=>g.comment=s),placeholder:"Write your comment...",rows:"4",class:"w-full border-2 border-gray-300 p-2 rounded-md"},null,512),[[Z,g.comment]]),c(M).comment.$error?(l(),N(te,{key:1},{default:L(()=>[p(a(c(M).comment.$errors[0].$message),1)]),_:1})):u("",!0),e("div",{class:"mt-4 flex gap-2"},[e("button",{onClick:be,class:"bg-green-800 text-white py-2 px-4 rounded shadow hover:bg-green-600 transition"}," Submit "),e("button",{onClick:Y,class:"bg-red-800 text-white py-2 px-4 rounded shadow hover:bg-red-600 transition"}," Cancel ")])])])):u("",!0)]),e("div",_t,[e("button",{onClick:ge,class:"hidden md:flex bg-yellow-100 border-2 border-gray-300 rounded-full p-3 fixed bottom-4 right-4 shadow-md hover:bg-yellow-300 items-center justify-center"},[i(c(x),{icon:"tabler:message",width:"28",height:"28",style:{color:"#608C54"}})])]),R.value?(l(),r("div",bt,[e("div",yt,[t[16]||(t[16]=e("span",{class:"text-xl font-bold text-green-600"},"Chat",-1)),e("button",{onClick:he,class:"text-gray-600 text-lg"},[i(c(x),{icon:"icon-park-solid:close-one",width:"20",height:"20"})])]),e("div",wt,[e("div",Ct,[e("div",kt,[i(Ae,{placeholder:"Search...",class:"2xl:w-[270px] 2xs:w-[137px]"})]),e("div",Mt,[(l(!0),r(S,null,j(T.value,s=>(l(),r("div",{key:s.id,class:"flex items-center p-3 border-b cursor-pointer hover:bg-gray-100 transition duration-200",onClick:h=>fe(s.id)},[e("img",{src:s.chat_partner_avatar,class:"w-12 h-12 rounded-full border mr-3",alt:"Avatar"},null,8,Dt),e("div",It,[e("span",Rt,a(s.chat_partner_name),1),e("p",$t,a(s.message),1)]),s.unread_messages_count?(l(),r("span",jt,a(s.unread_messages_count),1)):u("",!0),e("button",{onClick:h=>ye(s.id,h)},[i(c(x),{icon:"mdi-light:delete",width:"20",height:"20",style:{color:"#ad1414"}})],8,At),$.value?(l(),r("div",Pt,[e("div",Vt,[t[17]||(t[17]=e("h3",{class:"text-xl font-semibold text-center"},"Are you sure you want to delete this conversation?",-1)),e("div",Bt,[e("button",{onClick:Ce,class:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700"},"Yes, Delete"),e("button",{onClick:t[3]||(t[3]=h=>we(h)),class:"px-4 py-2 bg-gray-300 text-gray-800 rounded hover:bg-gray-400"},"Cancel")])])])):u("",!0)],8,St))),128))])]),e("div",Nt,[m.value?(l(),r("div",Et,[e("div",Ft,[e("span",null,a(m.value.chat_partner_name),1),e("button",{onClick:me,class:"text-gray-500"},"Close")]),e("div",Tt,[(l(!0),r(S,null,j(q.value,s=>(l(),r("div",{key:s.id,class:A(["flex items-start space-x-3",{"justify-end":s.sender.id===v.value,"justify-start":s.sender.id!==v.value}])},[s.sender.id!==v.value?(l(),r("img",{key:0,src:s.sender.avatar||z.value,class:"w-8 h-8 rounded-full"},null,8,qt)):u("",!0),e("div",{class:A(["p-3 rounded-lg shadow-md w-auto max-w-xs",{"bg-green-500 text-white":s.sender.id===v.value,"bg-gray-200 text-black":s.sender.id!==v.value}])},[e("p",{class:A(["text-sm font-bold",{"text-white":s.sender.id===v.value,"text-green-600":s.sender.id!==v.value}])},a(s.sender.first_name)+" "+a(s.sender.last_name),3),e("p",zt,a(s.message),1)],2),s.sender.id===v.value?(l(),r("div",Ut)):u("",!0)],2))),128))]),e("div",Wt,[X(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>y.message=s),type:"text",placeholder:"Type a message here",class:"flex-1 p-2 border rounded-md text-sm"},null,512),[[Z,y.message]]),e("button",{onClick:pe,class:"ml-2 bg-green-600 text-white px-4 py-2 rounded-md transition duration-200 hover:bg-green-700"}," Send ")])])):(l(),r("div",Lt,t[18]||(t[18]=[e("p",{class:"text-xl"},"Welcome to Pagsasaka Chat",-1)])))])])])):u("",!0)]),i(Pe)],64)}}};export{ts as default};
