import{_ as N}from"./Market_NavBar-i71B-ZDv.js";import{_ as P}from"./Footer-DRvzb5Y6.js";import{_ as w}from"./BaseCheckBox-CSBq413k.js";import{_ as Q}from"./BaseInputField-D7-GfNU_.js";import{L as D,T as F}from"./Toast-BXauPSI2.js";import"./lodash-9wNbgOht.js";import{A as h,i as M,g as k,p as V,f as q,c as d,E as z,l as g,a as l,b as s,r as G,u as f,I as _,d as O,e as R,F as Y,h as H,t as c,j as J,o as a}from"./index-DRxrXVja.js";/* empty css                                                              */const K={class:"min-h-screen flex flex-col"},W={class:"flex-grow"},X={key:0},Z={class:"p-4 w-full h-full"},I={key:1,class:"flex flex-col items-center justify-center py-20 text-gray-500 text-center gap-2"},ee={key:2},te={class:"p-4 w-full h-full"},se={class:"flex justify-between items-center mb-4"},oe={class:"text-lg font-bold text-[#608C54] flex items-center"},le={class:"h-[400px] max-h-[400px] overflow-y-auto border border-gray-300 rounded-lg"},ie={class:"flex items-center md:col-span-2 space-x-4"},ne=["src"],ae={class:"font-semibold"},de={class:"text-gray-500 text-sm"},ce={class:"md:col-span-1 text-center"},re={class:"text-gray-700 font-medium"},ue={class:"md:col-span-1 text-center"},pe={class:"flex items-center justify-center text-sm text-white space-x-2"},he=["onClick"],me=["onClick"],fe={class:"md:col-span-1 text-center"},_e={class:"text-gray-700 font-medium"},ge={class:"flex flex-col md:flex-row justify-between items-center p-4 border-t border-gray-300 mt-4 space-y-4 md:space-y-0"},xe={class:"flex items-center space-x-3"},ye={class:"text-right space-y-1"},ve={class:"font-bold text-lg"},Se={__name:"Add_Cart",setup(be){const r=M(),T=J(),L=h(()=>r.state.showLoading.state),i=h(()=>r.state.Consumer.cartItem.data);function A(){r.dispatch("Consumer/getCartList").then(()=>{i.value.forEach(t=>{t.selected===void 0&&(t.selected=!1)}),u.value=i.value.every(t=>t.selected)})}k(()=>{A(),V(i,t=>{t.forEach(e=>{e.selected===void 0&&(e.selected=!0)})})});const u=q(!1);function S(){i.value.forEach(t=>{t.selected=u.value})}V(()=>i.value.map(t=>t.selected),t=>{const e=t.filter(Boolean).length;u.value=e===i.value.length,e>=2&&(u.value=!0)},{deep:!0});const x=h(()=>i.value.filter(t=>t.selected).length),U=h(()=>i.value.filter(t=>t.selected).reduce((t,e)=>t+e.price*e.quantity,0).toFixed(2)),m=new Map;function y(t){m.has(t.id)&&clearTimeout(m.get(t.id));const e=setTimeout(()=>{r.dispatch("Consumer/updateQuantity",{id:t.id,quantity:t.quantity}),m.delete(t.id)},900);m.set(t.id,e)}function $(t){const e=i.value.find(n=>n.id===t);e&&(e.quantity++,y(e))}function j(t){const e=i.value.find(n=>n.id===t);e&&e.quantity>1&&(e.quantity--,y(e))}const v=h(()=>i.value.filter(t=>t.selected).length);async function B(){const t=i.value.filter(e=>e.selected).map(e=>e.id);await Promise.all(t.map(e=>r.dispatch("Consumer/deleteCart",e))),await r.dispatch("Consumer/getCartList")}const E=async()=>{const t=i.value.filter(e=>e.selected);if(t.length!==0){for(const e of t)try{await r.dispatch("Consumer/Checkout",{id:e.id})}catch(n){console.error("Checkout failed for item:",e.id,n)}T.push("/checkout")}},b=q(!0);return k(()=>{setTimeout(()=>{b.value=!1},2e3)}),(t,e)=>{const n=G("n-skeleton");return a(),d("div",K,[L.value?(a(),z(D,{key:0,class:"loading"})):g("",!0),l(F),l(N),s("div",W,[b.value?(a(),d("div",X,[l(n,{text:"",repeat:2}),s("div",Z,[l(n,{height:"30px",width:"50%",class:"mb-4"}),l(n,{height:"20px",width:"80%",class:"mb-4"}),l(n,{height:"40px",width:"100%",class:"mb-4"}),l(n,{height:"200px",width:"100%",class:"mb-4"}),l(n,{height:"50px",width:"100%",class:"mb-4"})]),l(n,{text:"",style:{width:"70%"}})])):i.value.length===0?(a(),d("div",I,[e[1]||(e[1]=s("p",{class:"text-xl"},"Your cart is currently empty.",-1)),l(f(_),{icon:"mynaui:sad-ghost-solid",width:"100",height:"100",style:{color:"#9faba4"}})])):(a(),d("div",ee,[s("div",te,[s("div",se,[s("h2",oe,[e[2]||(e[2]=R(" Add to cart ")),e[3]||(e[3]=s("span",{class:"ml-2 w-24 border-dotted border-b-2 border-[#608C54]"},null,-1)),l(f(_),{icon:"bitcoin-icons:cart-filled",width:"24",height:"24",style:{color:"#608C54"}})])]),e[4]||(e[4]=O('<div class="hidden md:grid md:grid-cols-6 gap-4 items-center bg-gray-100 p-3 text-sm font-medium border-t border-b border-gray-300"><p class="col-span-2 text-gray-500">Product</p><p class="col-span-1 text-gray-500 text-center">Unit Price</p><p class="col-span-1 text-gray-500 text-center">Quantity</p><p class="col-span-1 text-gray-500 text-center">Total Price</p></div>',1)),s("div",le,[(a(!0),d(Y,null,H(i.value,o=>{var C;return a(),d("div",{key:o.id,class:"grid grid-cols-1 md:grid-cols-6 gap-4 items-center p-4 border-b border-gray-300"},[s("div",ie,[l(w,{modelValue:o.selected,"onUpdate:modelValue":p=>o.selected=p,id:`cart-item-${o.id}`,class:"mr-2"},null,8,["modelValue","onUpdate:modelValue","id"]),(C=o==null?void 0:o.product_img)!=null&&C.length?(a(),d("img",{key:0,src:o.product_img[0],alt:"Product",class:"w-16 h-16 rounded-lg"},null,8,ne)):g("",!0),s("div",null,[s("h3",ae,c(o.product_name),1),s("p",de,"Variants: "+c(o.unit),1)])]),s("div",ce,[s("p",re,"₱"+c(o.price),1)]),s("div",ue,[s("div",pe,[s("button",{onClick:p=>j(o.id)},[l(f(_),{icon:"zondicons:minus-solid",width:"20",height:"20",style:{color:"#608C54"}})],8,he),l(Q,{modelValue:o.quantity,"onUpdate:modelValue":p=>o.quantity=p,class:"w-14 text-center border rounded"},null,8,["modelValue","onUpdate:modelValue"]),s("button",{onClick:p=>$(o.id)},[l(f(_),{icon:"gridicons:add",width:"24",height:"24",style:{color:"#608C54"}})],8,me)])]),s("div",fe,[s("p",_e,"₱"+c(o.price*o.quantity),1)])])}),128))]),s("div",ge,[s("div",xe,[l(w,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=o=>u.value=o),onChange:S},null,8,["modelValue"]),s("p",null,"Select All ("+c(x.value)+")",1),v.value>0?(a(),d("button",{key:0,onClick:B,class:"text-red-800 hover:text-red-600"},c(v.value===1?"Delete":"Delete All"),1)):g("",!0)]),s("div",ye,[s("p",ve,"Total ("+c(x.value)+" items): ₱"+c(U.value),1)])]),s("div",{class:"text-end mt-4 flex justify-end"},[s("button",{onClick:E,class:"bg-[#608C54] text-white px-6 py-2 rounded-lg block md:inline-block"},"Check Out")])])]))]),l(P)])}}};export{Se as default};
