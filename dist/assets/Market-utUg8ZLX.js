import{g as B,m as Se,p as ce,q,s as he,v as Ie,x as je,y as We,z as T,A as m,B as D,C as Le,u as j,_ as Ve,i as Te,f as P,D as ie,c as h,E as De,l as C,a as y,b as e,w as re,r as de,I as A,F as V,h as z,t as f,e as R,G as Ee,H as Ne,j as Pe,o as d,k as G}from"./index-wueJSqPO.js";import{_ as Ae}from"./Footer-D4NfBxCV.js";import{_ as ze}from"./Market_NavBar-BFVNpgch.js";import{B as Be}from"./BaseLabel-B8JK2irV.js";import{L as Oe,T as $e}from"./Toast-MUAU_amP.js";import"./lodash-D2iM17Ep.js";/* empty css                                                              */const Fe="/assets/Mfarmer-owAHeeum.png";function He(o){return je()?(We(o),!0):!1}const Y=new WeakMap,Re=(...o)=>{var t;const u=o[0],v=(t=q())==null?void 0:t.proxy;if(v==null&&!he())throw new Error("injectLocal must be called in setup");return v&&Y.has(v)&&u in Y.get(v)?Y.get(v)[u]:Ie(...o)},Ge=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Ye=Object.prototype.toString,Qe=o=>Ye.call(o)==="[object Object]";function ue(o){return o.endsWith("rem")?Number.parseFloat(o)*16:Number.parseFloat(o)}function Q(o){return Array.isArray(o)?o:[o]}function Ue(o){return q()}function qe(o,t=!0,u){Ue()?B(o,u):t?o():Se(o)}function Je(o,t,u){return ce(o,t,{...u,immediate:!0})}const J=Ge?window:void 0;function Ke(o){var t;const u=D(o);return(t=u==null?void 0:u.$el)!=null?t:u}function U(...o){const t=[],u=()=>{t.forEach(i=>i()),t.length=0},v=(i,a,r,c)=>(i.addEventListener(a,r,c),()=>i.removeEventListener(a,r,c)),p=m(()=>{const i=Q(D(o[0])).filter(a=>a!=null);return i.every(a=>typeof a!="string")?i:void 0}),k=Je(()=>{var i,a;return[(a=(i=p.value)==null?void 0:i.map(r=>Ke(r)))!=null?a:[J].filter(r=>r!=null),Q(D(p.value?o[1]:o[0])),Q(j(p.value?o[2]:o[1])),D(p.value?o[3]:o[2])]},([i,a,r,c])=>{if(u(),!(i!=null&&i.length)||!(a!=null&&a.length)||!(r!=null&&r.length))return;const M=Qe(c)?{...c}:c;t.push(...i.flatMap(_=>a.flatMap(g=>r.map(b=>v(_,g,b,M)))))},{flush:"post"}),x=()=>{k(),u()};return He(u),x}function Xe(){const o=T(!1),t=q();return t&&B(()=>{o.value=!0},t),o}function Ze(o){const t=Xe();return m(()=>(t.value,!!o()))}const et=Symbol("vueuse-ssr-width");function tt(){const o=he()?Re(et,null):null;return typeof o=="number"?o:void 0}function st(o,t={}){const{window:u=J,ssrWidth:v=tt()}=t,p=Ze(()=>u&&"matchMedia"in u&&typeof u.matchMedia=="function"),k=T(typeof v=="number"),x=T(),i=T(!1),a=r=>{i.value=r.matches};return Le(()=>{if(k.value){k.value=!p.value;const r=D(o).split(",");i.value=r.some(c=>{const M=c.includes("not all"),_=c.match(/\(\s*min-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/),g=c.match(/\(\s*max-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/);let b=!!(_||g);return _&&b&&(b=v>=ue(_[1])),g&&b&&(b=v<=ue(g[1])),M?!b:b});return}p.value&&(x.value=u.matchMedia(D(o)),i.value=x.value.matches)}),U(x,"change",a,{passive:!0}),m(()=>i.value)}function ot(o={}){const{window:t=J,initialWidth:u=Number.POSITIVE_INFINITY,initialHeight:v=Number.POSITIVE_INFINITY,listenOrientation:p=!0,includeScrollbar:k=!0,type:x="inner"}=o,i=T(u),a=T(v),r=()=>{if(t)if(x==="outer")i.value=t.outerWidth,a.value=t.outerHeight;else if(x==="visual"&&t.visualViewport){const{width:M,height:_,scale:g}=t.visualViewport;i.value=Math.round(M*g),a.value=Math.round(_*g)}else k?(i.value=t.innerWidth,a.value=t.innerHeight):(i.value=t.document.documentElement.clientWidth,a.value=t.document.documentElement.clientHeight)};r(),qe(r);const c={passive:!0};if(U("resize",r,c),t&&x==="visual"&&t.visualViewport&&U(t.visualViewport,"resize",r,c),p){const M=st("(orientation: portrait)");ce(M,()=>r())}return{width:i,height:a}}const nt={class:"relative"},lt=["src"],at={class:"flex flex-col items-center space-y-4 2xl:p-8 2xs:p-4 bg-[#285a19]"},it={class:"flex justify-center 2xs:w-full"},rt=["src"],dt={class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300"},ut=["onClick"],ct={class:"bg-gray-100 min-h-screen p-4"},ht={class:"flex flex-col md:flex-row"},vt={class:"w-full h-64 md:w-1/4 bg-white shadow-md rounded-lg p-4 mb-4 md:mb-0"},ft={class:"space-y-2 bg-white shadow-md rounded-lg p-4"},mt={class:"border border-gray-300 rounded-lg p-4"},gt={class:"mb-4 text-xs"},pt={class:"p-4 mt-12"},xt={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-5 grid-rows-2 gap-4"},bt=["onMouseenter"],yt=["src"],_t={class:"absolute inset-0 flex items-center justify-center bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity"},wt=["onClick"],Ct={class:"p-2"},kt={class:"text-sm font-semibold"},Mt={class:"text-xs font-semibold"},St={class:"text-red-500 font-bold text-sm"},It={class:"text-gray-600 text-xs mt-1"},jt={key:0,class:"text-gray-600 text-xs mt-2"},Wt={key:1,class:"mt-2"},Lt={key:0,class:"text-gray-500"},Vt=["onClick"],Tt=["onClick"],Dt={class:"mt-10 mr-4 flex justify-center text-sm"},Et=["disabled"],Nt={class:"py-2 px-4 bg-gray-100 flex text-sm items-center border-l border-r border-gray-300"},Pt=["disabled"],At={class:"h-full w-full p-10"},zt={class:"max-w-4xl mx-auto p-4 border-2 border-green-500 rounded-lg"},Bt={class:"flex items-center mb-6"},Ot={class:"mr-6 hidden sm:block"},$t={class:"p-4"},Ft={key:0,class:"fixed bottom-4 right-4 2xl:w-[900px] 2xs:w-[470px] 2xl:h-[85vh] 2xs:h-[65vh] bg-white rounded-lg shadow-lg flex flex-col border z-50"},Ht={class:"p-4 border-b rounded-sm bg-gray-100 flex justify-between items-center"},Rt={class:"flex flex-1 overflow-hidden"},Gt={class:"w-1/3 bg-white border-r border-gray-300 p-4 flex flex-col"},Yt={class:"mt-3 flex-1 overflow-auto"},Qt=["onClick"],Ut=["src"],qt={class:"flex-1"},Jt={class:"font-semibold"},Kt={key:0,class:"text-xs bg-red-500 text-white px-2 py-1 rounded-full"},Xt=["onClick"],Zt={key:1,class:"fixed inset-0 bg-gray-500 bg-opacity-75 flex justify-center items-center z-50"},es={class:"bg-white p-6 rounded shadow-lg w-96"},ts={class:"flex justify-around mt-4"},ss={class:"w-full flex flex-col"},os={key:0,class:"flex-1 flex items-center justify-center text-gray-400"},ns={key:1,class:"flex flex-col h-full"},ls={class:"p-4 border-b flex justify-between items-center bg-gray-100"},as={class:"text-lg font-semibold"},is={class:"flex-1 bg-gray-50 p-4 overflow-auto space-y-4 2xl:text-sm 2xs:text-sm max-h-[400px]"},rs=["src"],ds={class:"text-xs"},us=["src"],cs={class:"p-4 border-t bg-gray-50 flex items-center"},hs={__name:"Market",setup(o){const t=Te(),u=Pe(),v=m(()=>t.state.showLoading.state),p=m(()=>t.state.Consumer.conversation.data),k=m(()=>t.state.Consumer.message.data),x=m(()=>t.state.Consumer.productItem.data),i=m(()=>t.state.Consumer.moreProduct.data),a=m(()=>t.state.currentPage),r=m(()=>t.state.totalPages),c=m(()=>{var l,n;return((n=(l=t.state.userData.data)==null?void 0:l.user)==null?void 0:n.id)||null}),M=m(()=>{var l,n;return((n=(l=t.state.userData.data)==null?void 0:l.user)==null?void 0:n.avatar)||defaultAvatar.value}),_=m(()=>t.state.Consumer.productRatings),g=P({});function b(){t.dispatch("Consumer/getConversation")}B(()=>{b()});const{width:W}=ot(),ve=m(()=>W.value>=1536?5:W.value>=1280?4:W.value>=1024?3:W.value>=768?4:W.value>=640?3:(W.value>=480,1));function fe(){t.dispatch("Consumer/getItemList")}B(()=>{fe()});async function K(l){sessionStorage.setItem("ItemInfo",l),u.push({name:"Market_Page1"})}async function $(){await t.dispatch("Consumer/getMoreList",{currentPage:a.value})}B(()=>{$()}),ie({all:!0,vegetable:!1,seed:!1,grains:!1,soil:!1,fruits:!1,pelletes:!1,process:!1});async function X(l){var n;(n=_.value)!=null&&n[l]||await t.dispatch("Consumer/getProductRatings",l)}function E(l){var n;return((n=_.value)==null?void 0:n[l])||null}function Z(l){g.value[l]=!g.value[l],g.value[l]&&X(l)}function me(){a.value>1&&(t.commit("setCurrentPage",a.value-1),$())}function ge(){a.value<r.value&&(t.commit("setCurrentPage",a.value+1),$())}const F=P(!1),S=P(null),N=ie({message:""}),pe=()=>{S.value=null},xe=()=>{F.value=!0},be=()=>{F.value=!1},ye=l=>{console.log("Selected chat ID:",l);const n=p.value.find(H=>H.id===l);S.value=n,t.dispatch("Consumer/getMessages",l)},_e=async()=>{if(!N.message.trim()||!S.value)return;const l={id:S.value.id,message:N.message};try{await t.dispatch("Consumer/sendMessage",l),await t.dispatch("Consumer/getMessages",S.value.id),N.message=""}catch(n){console.error("Failed to send message:",n)}},O=P(!1),L=P(null),we=(l,n)=>{n.stopPropagation(),O.value=!0,L.value=l},Ce=l=>{l.stopPropagation(),O.value=!1,L.value=null},ke=async()=>{var l;if(L.value)try{await t.dispatch("Consumer/deleteConversation",L.value),O.value=!1,L.value=null,b(),((l=S.value)==null?void 0:l.id)===L.value&&(S.value=null,k.value=[])}catch(n){console.error("Failed to delete conversation:",n)}};return(l,n)=>{const H=de("n-carousel"),Me=de("n-rate");return d(),h(V,null,[v.value?(d(),De(Oe,{key:0,class:"loading"})):C("",!0),y($e),e("div",null,[y(ze),e("div",nt,[e("img",{src:j(Fe),alt:"",class:"object-fill 2xl:h-[500px] w-full"},null,8,lt)]),e("div",at,[n[2]||(n[2]=e("div",{class:"text-center w-full"},[e("h2",{class:"2xl:text-2xl 2xs:text-sm xl:text-2xl lg:text-2xl font-bold text-white"},"Grab this now"),e("p",{class:"mt-2 2xl:text-lg 2xs:text-xs lg:text-lg xl:text-lg text-gray-300 max-w-3xl mx-auto"}," Explore our curated selection of high-quality goods, featuring fresh produce, artisanal items, and everyday essentials, all while supporting local farmers and communities. ")],-1)),e("div",it,[y(H,{"slides-per-view":ve.value,"space-between":20,loop:!1,draggable:"","show-arrow":""},{default:re(()=>[(d(!0),h(V,null,z(x.value,s=>(d(),h("div",{key:s.id,class:"border-2 border-[#608C54] relative group w-20 h-20 sm:w-32 xl:w-48 sm:h-32 md:w-32 md:h-32 xl:h-48 lg:w-56 lg:h-56 2xs:w-56 2xs:h-56 rounded-lg overflow-hidden mx-auto"},[e("img",{src:s.product_img[0],alt:"Carousel Image",class:"w-full h-full object-cover transition-transform duration-300 transform group-hover:scale-110"},null,8,rt),e("div",dt,[e("button",{onClick:I=>K(s.id),class:"px-2 py-1 2xl:px-4 md:px-2 2xl:py-2 text-xs sm:text-sm md:text-xs text-white bg-green-500 rounded-lg"}," View Product ",8,ut)])]))),128))]),_:1},8,["slides-per-view"])])]),e("div",ct,[e("div",ht,[e("div",vt,[e("div",ft,[e("div",mt,[e("div",gt,[y(j(A),{icon:"mdi-light:truck",width:"52",height:"52",style:{color:"#346a3d"}}),y(Be,{class:"block text-lg font-medium text-gray-700"},{default:re(()=>n[3]||(n[3]=[R("Delivery every day ")])),_:1}),n[4]||(n[4]=e("div",null,[e("p",null,"Learn More on our"),e("a",{href:"/delivery-guide",class:"px-4 py-2 text-[#608C54] hover:underline"},"Delivery Guide")],-1))])])])]),e("div",pt,[e("div",xt,[(d(!0),h(V,null,z(i.value.slice(0,10),s=>{var I,ee,te,se,oe,ne,le,ae;return d(),h("div",{key:s.id,class:"relative border rounded-lg shadow-sm overflow-hidden hover:shadow-md transition-shadow group",onMouseenter:w=>X(s.id)},[e("img",{src:s.product_img[0],alt:"Product Image",class:"w-full h-40 object-cover"},null,8,yt),e("div",_t,[e("button",{onClick:w=>K(s.id),class:"px-2 py-1 2xl:px-4 md:px-2 2xl:py-2 text-xs sm:text-sm md:text-xs text-white bg-green-500 rounded-lg"}," View Product ",8,wt)]),e("div",Ct,[e("h3",kt,f(s.product_name),1),e("p",Mt,f(s.description),1),e("div",St,"₱"+f(s.price),1),y(Me,{"allow-half":"",readonly:"",value:((I=E(s.id))==null?void 0:I.average_rating)||0,size:"small"},null,8,["value"]),e("div",It,f(((ee=E(s.id))==null?void 0:ee.total_ratings)||0)+" reviews ",1),s.location?(d(),h("div",jt," 📍 "+f(s.location),1)):C("",!0),g.value[s.id]?(d(),h("div",Wt,[n[5]||(n[5]=e("h4",{class:"text-xs font-semibold"},"Comments:",-1)),(d(!0),h(V,null,z(((se=(te=E(s.id))==null?void 0:te.ratings)==null?void 0:se.data)||[],w=>(d(),h("div",{key:w.id,class:"text-xs mt-1"},[e("p",null,[e("strong",null,f(w.account.first_name)+" "+f(w.account.last_name),1),R(": "+f(w.comment),1)]),w.seller_response?(d(),h("p",Lt,"Seller: "+f(w.seller_response),1)):C("",!0)]))),128)),(le=(ne=(oe=E(s.id))==null?void 0:oe.ratings)==null?void 0:ne.data)!=null&&le.length?(d(),h("button",{key:0,onClick:w=>Z(s.id),class:"text-xs text-green-600 hover:underline"}," Hide Comments ",8,Vt)):C("",!0)])):((ae=E(s.id))==null?void 0:ae.total_ratings)>0?(d(),h("button",{key:2,onClick:w=>Z(s.id),class:"text-xs text-green-600 hover:underline"},null,8,Tt)):C("",!0)])],40,bt)}),128))]),e("div",Dt,[e("button",{type:"button",class:"py-2 px-4 bg-gray-100 rounded-tl-lg rounded-bl-lg hover:bg-gray-200 text-gray-600",onClick:me,disabled:a.value===1},"Previous",8,Et),e("span",Nt,f(a.value)+" of "+f(r.value),1),e("button",{type:"button",class:"py-2 px-4 bg-gray-100 rounded-tr-lg rounded-br-lg hover:bg-gray-200 text-gray-600",onClick:ge,disabled:a.value===r.value},"Next",8,Pt)])])])]),e("div",At,[e("div",zt,[n[7]||(n[7]=e("h2",{class:"text-3xl text-center font-bold text-green-600 mb-4"},"Delivery Policy",-1)),e("div",Bt,[e("div",Ot,[y(j(A),{icon:"material-symbols-light:delivery-truck-speed",width:"112",height:"112",style:{color:"#12a246"}})]),n[6]||(n[6]=e("div",null,[e("p",{class:"text-gray-800 text-base mb-4"}," We work with a team of regular drivers and third-party providers to handle all of our deliveries. Please make sure you are contactable by our drivers on the day and that clear instructions are given for the receiving of items to avoid delays and possible issues. "),e("p",{class:"text-gray-800 text-base font-semibold"}," We implement a 15-minute waiting time for all our deliveries. In the event that the recipient cannot be contacted, our personnel will return your order to us. You can pick it up in our office. "),e("p",{class:"text-gray-800 text-base mt-4"},[R(" To reduce food waste, for orders involving fresh produce—"),e("span",{class:"font-bold"},"all items that are not picked up within the same week of the scheduled pickup or delivery will be considered good as sold.")])],-1))])]),e("div",$t,[e("button",{onClick:xe,class:"hidden md:flex bg-yellow-100 border-2 border-gray-300 rounded-full p-3 fixed bottom-4 right-4 shadow-md hover:bg-yellow-300 items-center justify-center"},[y(j(A),{icon:"tabler:message",width:"28",height:"28",style:{color:"#608C54"}})])]),F.value?(d(),h("div",Ft,[e("div",Ht,[n[8]||(n[8]=e("span",{class:"text-xl font-bold text-green-600"},"Chat",-1)),e("button",{onClick:be,class:"text-gray-600 text-lg"},[y(j(A),{icon:"icon-park-solid:close-one",width:"20",height:"20"})])]),e("div",Rt,[e("div",Gt,[e("div",Yt,[(d(!0),h(V,null,z(p.value,s=>(d(),h("div",{key:s.id,class:"flex items-center p-3 border-b cursor-pointer hover:bg-gray-100 transition duration-200",onClick:I=>ye(s.id)},[e("img",{src:s.chat_partner_avatar||l.defaultAvatar,class:"w-12 h-12 rounded-full border mr-3",alt:"Avatar"},null,8,Ut),e("div",qt,[e("span",Jt,f(s.chat_partner_name),1)]),s.unread_messages_count?(d(),h("span",Kt,f(s.unread_messages_count),1)):C("",!0),e("button",{onClick:I=>we(s.id,I)},[y(j(A),{icon:"mdi-light:delete",width:"20",height:"20",style:{color:"#ad1414"}})],8,Xt),O.value?(d(),h("div",Zt,[e("div",es,[n[9]||(n[9]=e("h3",{class:"text-xl font-semibold text-center"},"Are you sure you want to delete this conversation?",-1)),e("div",ts,[e("button",{onClick:ke,class:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700"},"Yes, Delete"),e("button",{onClick:n[0]||(n[0]=I=>Ce(I)),class:"px-4 py-2 bg-gray-300 text-gray-800 rounded hover:bg-gray-400"},"Cancel")])])])):C("",!0)],8,Qt))),128))])]),e("div",ss,[S.value?(d(),h("div",ns,[e("div",ls,[e("h2",as,f(S.value.chat_partner_name),1),e("button",{onClick:pe,class:"text-gray-500"},"Close")]),e("div",is,[(d(!0),h(V,null,z(k.value,s=>(d(),h("div",{key:s.id,class:G(["flex items-start space-x-3",{"justify-end":s.sender.id===c.value,"justify-start":s.sender.id!==c.value}])},[s.sender.id!==c.value?(d(),h("img",{key:0,src:s.sender.avatar||l.defaultAvatar,class:"w-8 h-8 rounded-full"},null,8,rs)):C("",!0),e("div",{class:G(["p-3 rounded-lg shadow-md w-auto max-w-xs",{"bg-green-500 text-white":s.sender.id===c.value,"bg-gray-200 text-black":s.sender.id!==c.value}])},[e("p",{class:G(["text-sm font-bold",{"text-white":s.sender.id===c.value,"text-green-600":s.sender.id!==c.value}])},f(s.sender.id===c.value?"You":s.sender.first_name+" "+s.sender.last_name),3),e("p",ds,f(s.message),1)],2),s.sender.id===c.value?(d(),h("img",{key:1,src:M.value||l.defaultAvatar,class:"w-8 h-8 rounded-full"},null,8,us)):C("",!0)],2))),128))]),e("div",cs,[Ee(e("input",{"onUpdate:modelValue":n[1]||(n[1]=s=>N.message=s),type:"text",placeholder:"Type a message...",class:"flex-1 p-2 border rounded-md text-sm"},null,512),[[Ne,N.message]]),e("button",{onClick:_e,class:"ml-2 bg-green-500 text-white px-4 py-2 rounded-md transition duration-200 hover:bg-green-700"}," Send ")])])):(d(),h("div",os,n[10]||(n[10]=[e("p",{class:"text-xl"},"Welcome to Pagsasaka Chat",-1)])))])])])):C("",!0)]),y(Ae)])],64)}}},ys=Ve(hs,[["__scopeId","data-v-4e5c296d"]]);export{ys as default};
