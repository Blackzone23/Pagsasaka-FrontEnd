import{f as i,A as m,i as j,g as M,c,E as V,l as p,a as d,b as e,r as b,w as B,u as v,I as x,t as l,F as w,h as G,k as _,j as I,o as u,e as q,G as F,K as N}from"./index-CpL9wR7w.js";import{B as $}from"./BaseLabel-HEn94prA.js";import{_ as E}from"./Footer-wIXg4wjx.js";import{_ as U}from"./Market_NavBar-D8N4B_ID.js";import"./Toast-mhXOF29r.js";/* empty css                                                              */import"./lodash--ewKp5e3.js";const z={class:"flex flex-col min-h-screen"},A={class:"p-5 flex-grow"},K={key:0,class:"flex flex-wrap items-center gap-2 border-2 border-[#608C54] py-5 p-2 rounded-md shadow-md mt-4"},Q={class:"mt-6 w-full mx-auto p-3 bg-white shadow-md border-2 border-[#608C54] rounded-lg"},R={class:"flex flex-wrap justify-between items-center mb-4 border-b pb-2"},W={class:"flex items-center space-x-2"},H={class:"overflow-y-auto border rounded-md p-2 max-h-[30rem]"},J={class:"flex space-x-4 items-center"},X=["onUpdate:modelValue"],Y=["src"],Z={class:"font-semibold"},ee={class:"text-sm text-gray-500"},te={class:"grid grid-cols-3 gap-4 text-center w-full sm:w-1/2 text-sm font-medium"},se={class:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6 mb-6 mt-6"},oe={class:"col-span-1 xl:col-span-2 pt-2"},le={class:"flex flex-wrap gap-4"},ae={class:"border-t pt-4 mb-6"},ne={class:"flex justify-between text-sm mb-2"},re={class:"flex justify-between text-sm mb-2"},ie={class:"flex justify-between text-lg font-bold"},y=3e3,de=30,ve={__name:"Checkout",setup(ue){const n=j(),C=I(),a=i([]),T=m(()=>{var s;return((s=n.state.showLoading)==null?void 0:s.state)||!1}),f=m(()=>a.value.filter(s=>s.selected).reduce((s,t)=>s+t.price*t.quantity,0)),g=m(()=>a.value.filter(s=>s.selected).reduce((s,t)=>s+de*t.quantity,0)),D=m(()=>f.value+g.value),r=i(null);i(""),i(""),i(""),i(""),i("");function O(){n.dispatch("Consumer/getCheckoutList").then(s=>{a.value=(s.cart_statuses||[]).map(t=>({...t,selected:!0}))})}M(()=>{O()});const P=async()=>{if(!r.value){n.commit("Consumer/showToast",{showToast:!0,toastMessage:"Please select a payment method",toastType:"error"}),setTimeout(()=>{n.commit("Consumer/showToast",{showToast:!1,toastMessage:"",toastType:"default"})},y);return}const s=a.value.filter(t=>t.selected);if(s.length===0){n.commit("Consumer/showToast",{showToast:!0,toastMessage:"Please select at least one item",toastType:"error"}),setTimeout(()=>{n.commit("Consumer/showToast",{showToast:!1,toastMessage:"",toastType:"default"})},y);return}try{if(n.commit("Consumer/setCheckout",s),r.value==="COD")console.log("Dispatching placeCODOrder with selected items:",s),await n.dispatch("Consumer/placeCODOrder"),C.push("/profile");else if(r.value==="GCash"){console.log("Dispatching placeGCashOrder with selected items:",s);const t=await n.dispatch("Consumer/placeGCashOrder");t.isSuccess?window.location.href=t.checkout_url:console.error("Failed to create payment session:",t.message)}}catch(t){console.error("Checkout failed:",t)}};return(s,t)=>{const k=b("Loading"),L=b("Toast");return u(),c(w,null,[T.value?(u(),V(k,{key:0,class:"loading"})):p("",!0),d(L),d(U),e("div",z,[e("div",A,[d($,{class:"text-3xl font-bold"},{default:B(()=>t[2]||(t[2]=[q("Check out")])),_:1}),a.value.length?(u(),c("div",K,[d(v(x),{icon:"lsicon:location-outline",width:"24",height:"24",style:{color:"#276d22"}}),t[3]||(t[3]=e("p",{class:"ml-2 font-semibold"},"Delivery address:",-1)),e("p",null,l(a.value[0].name),1),e("p",null,l(a.value[0].email),1),e("p",null,l(a.value[0].shipping_address),1),e("p",null,l(a.value[0].phone_number),1)])):p("",!0),e("div",Q,[e("div",R,[e("div",W,[d(v(x),{icon:"streamline:store-1",width:"28",height:"28",style:{color:"#276d22"}}),t[4]||(t[4]=e("h2",{class:"text-xl font-bold"},"Product ordered",-1))]),t[5]||(t[5]=e("div",{class:"hidden sm:grid grid-cols-3 gap-10 text-gray-600 text-sm text-center font-semibold w-full sm:w-1/2 mt-2 sm:mt-0"},[e("p",null,"Unit price"),e("p",null,"Quantity"),e("p",null,"Item subtotal")],-1))]),e("div",H,[(u(!0),c(w,null,G(a.value,o=>{var h;return u(),c("div",{key:o.id,class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4"},[e("div",J,[F(e("input",{type:"checkbox","onUpdate:modelValue":S=>o.selected=S,class:"mr-2"},null,8,X),[[N,o.selected]]),(h=o==null?void 0:o.product_img)!=null&&h.length?(u(),c("img",{key:0,src:o.product_img[0],alt:"Product Image",class:"w-20 h-20 rounded-md object-cover"},null,8,Y)):p("",!0),e("div",null,[e("h3",Z,l(o.product_name),1),e("p",ee,"Variants: "+l(o.unit),1)])]),e("div",te,[e("p",null,"₱"+l(o.price),1),e("p",null,l(o.quantity),1),e("p",null,"₱"+l(o.price*o.quantity),1)])])}),128))]),e("div",se,[e("div",oe,[t[6]||(t[6]=e("h3",{class:"font-semibold mb-2"},"Payment method",-1)),e("div",le,[e("button",{onClick:t[0]||(t[0]=o=>r.value="GCash"),class:_(["px-4 py-2 border rounded-md focus:outline-none transition",r.value==="GCash"?"bg-[#608C54] text-white":"bg-white text-black"])}," E-Wallet ",2),e("button",{onClick:t[1]||(t[1]=o=>r.value="COD"),class:_(["px-4 py-2 border rounded-md focus:outline-none transition",r.value==="COD"?"bg-[#608C54] text-white":"bg-white text-black"])}," COD ",2)])])]),e("div",ae,[e("div",ne,[t[7]||(t[7]=e("span",null,"Merchandise Subtotal",-1)),e("span",null,"₱"+l(f.value),1)]),e("div",re,[t[8]||(t[8]=e("span",null,"Shipping Subtotal",-1)),e("span",null,"₱"+l(g.value),1)]),e("div",ie,[t[9]||(t[9]=e("span",null,"Total Payment",-1)),e("span",null,"₱"+l(D.value),1)])]),e("div",{class:"text-right"},[e("button",{onClick:P,class:"bg-[#608C54] text-white px-6 py-2 rounded-md hover:bg-gray-300"}," Place order ")])])]),d(E)])],64)}}};export{ve as default};
